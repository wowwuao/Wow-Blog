---
title: 5.跨域
group:
    path: /net
    title: 计算机网络
---

# 跨域

## JSONP
通过动态创建 **`script`** 标签来实现跨域请求。因为浏览器对 **`script`** 标签的引入没有跨域的反问限制。

通过在请求的 url 后指定一个回调函数，然后服务器在返回数据的时候，构建一个 json 数据的包装，这个包装就是回调函数，然后返回给前端，前端接收到数据后，因为请求的是脚本文件，所以会执行，这样我们先前定义好的回调函数就可以被调用。

只适用于 **`GET`** 请求

## postMessage
这是 h5 新增的 api。通过它可以实现多窗口的信息传递，通过获取到指定窗口的引用，然后调用 `postMessage` 来发送信息，在窗口中我们通过对 `message` 信息的监听来接收信息，以此来实现不同源间的信息交换。

## CORS
跨域资源共享。CORS需要浏览器和服务器的支持，目前所有浏览器都支持该功能。

CORS请求分为两类：
* 简单请求
  浏览器直接发出CORS请求。在请求头中新增一个 `Origin` 字段。`Origin` 字段用来说明本次请求来自哪个源。服务端根据这个值，决定是否统一这次请求。对于如果Origin指定的源，不在许可范围内，服务器会返回一个正常的 HTTP 回应。浏览器发现，这个相应头信息没有包含 `Access-Control-Allow-Origin` 字段，从而抛出一个错误。如果成功的话，会包含 `Access-Control-` 开头的字段。

* 非简单请求
  浏览器会先发出依次预检请求，来判断该域名是否在服务器的白名单中，如果收到肯定回复后才会发起请求。

## WebSocket

## 服务器代理
