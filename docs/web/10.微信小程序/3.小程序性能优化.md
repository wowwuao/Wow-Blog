---
title: 3.小程序性能优化

group:
    path: /wxminiprogram
    title: "微信小程序"
    order: 10
---

# 小程序性能优化

## 加载
* 代码包的体积压缩可以通过勾选开发者工具中“上传代码时，压缩代码”选项
* 及时清理无用的代码和资源文件
* 减少资源包中的图片等资源的数量和大小

## 渲染
### 首屏渲染优化
* 请求可以在页面 onLoad 加载，不要等页面 ready 后在异步请求数据。
* 尽量减少不必要https请求，可使用 `getStorageSync()` 和 `setStorageSync()` 方法将数据存储在本地
* 可以在前置页面将一些有用的字段带到当前页，进行首次渲染（列表页的某些数据-->详情页），没有数据的模块可以进行骨架屏的占位。

### 重渲染
* 不要频繁调用setData，应该考虑将多次setData合并依次setData调用
* 数据通信的性能与数据量正相关，因而如果有一些数据字段不在界面中展示且数据结构比较复杂或包含长字符串，则不应该使用 setData 设置这些数据
* 与界面渲染无关的数据最好不要设置这些数据，可以考虑设置在page对象的其他字段下。


除此之外，独立的模块尽可能抽离出来，这是因为自定义组件的更新并不会影响页面上其他元素的更新。

## 总结
### 启动：
* 控制代码包的大小
* 分包加载
* 首屏体验（预请求，利用缓存，避免白屏，及时反馈）

## 渲染：
* 避免不当的使用setData
* 使用自定义组件